(function() {
  this.AppCtrl = function($scope, $location, $http, proxy) {
    return proxy.setUser(function(err, user) {
      if (err) {
        throw err;
      }
      return $scope.user = user;
    });
  };

}).call(this);

(function() {
  this.LoginCtrl = function($scope, $location, $http, proxy) {
    $scope.form = {
      name: {}
    };
    $scope.login = {};
    return $scope.register = function() {
      return proxy.register($scope.form, function(err, response) {
        if (err) {
          return console.log("Error registering: err");
        }
        return console.log("userregistered");
      });
    };
  };

}).call(this);

(function() {
  this.app = angular.module("theTribe", ["ngRoute", "ngAnimate"]);

  this.app.config([
    "$routeProvider", "$locationProvider", function($routeProvider, $locationProvider) {
      $routeProvider.when("/", {
        templateUrl: "/partials/home"
      });
      $routeProvider.when("/login", {
        templateUrl: "/partials/login"
      });
      $routeProvider.when("/register", {
        templateUrl: "/partials/register"
      });
      $locationProvider.html5Mode(true);
      return $locationProvider.hashPrefix("!");
    }
  ]);

}).call(this);

(function() {
  this.app.service("proxy", function($http) {
    return {
      register: function(form, callback) {
        return $http.post("/register", form).success(function(response) {
          return callback(null, response);
        }).error(function(response) {
          return callback("error", response);
        });
      },
      setUser: function(callback) {
        return $http.get("/user").success(function(response) {
          return callback(null, response);
        }).error(function(response) {
          return callback("not logged in", response);
        });
      }
    };
  });

}).call(this);
